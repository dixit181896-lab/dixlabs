<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MouseBreaker Empire | The Boardroom</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #ffcc00; --bg: #050505; --panel: #0d0d0f;
            --success: #00ff88; --royal: #7000ff; --danger: #ff0055;
            --disabled: #222225; --text: #e0e0e0;
        }
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; }
        /* CHANGED: Allow scrolling for elongated pages */
        body { margin: 0; background: var(--bg); color: var(--text); overflow-y: auto; display: flex; flex-direction: column; min-height: 100vh; }

        #news-ticker {
            background: #111; border-bottom: 1px solid #222; padding: 10px;
            font-family: 'Orbitron'; font-size: 0.75rem; color: var(--gold);
            white-space: nowrap; overflow: hidden; position: relative;
        }
        .ticker-wrap { display: inline-block; animation: ticker 30s linear infinite; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        #startup-overlay, #crisis-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.98); z-index: 5000; display: flex; align-items: center; justify-content: center;
        }
        #crisis-overlay { display: none; background: rgba(20, 0, 0, 0.95); z-index: 6000; }

        .startup-box, .crisis-box {
            background: var(--panel); border: 2px solid var(--gold); padding: 60px;
            border-radius: 24px; text-align: center; width: 600px; box-shadow: 0 0 80px rgba(255, 204, 0, 0.15);
        }
        .crisis-box { border-color: var(--danger); box-shadow: 0 0 100px rgba(255, 0, 85, 0.3); }

        .startup-input {
            width: 100%; padding: 18px; margin: 15px 0; background: #1a1a1c;
            border: 1px solid #333; color: var(--gold); font-family: 'Orbitron'; font-size: 1.1rem; border-radius: 8px;
        }

        .empire-hud { position: sticky; top: 0; z-index: 1000; padding: 25px 50px; background: #000; border-bottom: 3px solid var(--gold); display: flex; justify-content: space-between; align-items: center; }
        .capital-display { font-family: 'Orbitron'; font-size: 3rem; color: var(--gold); font-weight: 900; letter-spacing: -1px; }
        
        .main-layout { display: flex; flex: 1; }
        .content-area { flex: 1; padding: 40px; background: radial-gradient(circle at top left, #0a0a0c, #050505); }
        
        .enemy-sidebar { width: 380px; background: #08080a; border-left: 1px solid #222; padding: 30px; }
        .enemy-card { background: #121215; padding: 20px; margin-bottom: 18px; border-radius: 12px; border-right: 4px solid var(--danger); }
        .threat-bar { height: 10px; background: #222; margin-top: 15px; border-radius: 5px; overflow: hidden; }
        .threat-fill { height: 100%; background: var(--danger); transition: 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        .tabs-nav { display: flex; gap: 20px; margin-bottom: 40px; }
        .tab-btn { 
            background: transparent; border: none; color: #555; padding: 15px 30px; 
            cursor: pointer; font-family: 'Orbitron'; font-weight: 900; font-size: 1rem;
            text-transform: uppercase; letter-spacing: 2px; border-bottom: 2px solid transparent;
        }
        .tab-btn.active { color: var(--gold); border-bottom: 2px solid var(--gold); }
        
        .view { display: none; }
        .view.active { display: block; animation: slideUp 0.5s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .grid-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); gap: 30px; }
        .card { 
            background: rgba(20, 20, 25, 0.8); padding: 35px; border-radius: 20px; 
            border: 1px solid #222; transition: 0.3s; position: relative; overflow: hidden;
        }
        .card:hover { border-color: var(--gold); background: #16161a; transform: translateY(-5px); }
        .card h3 { margin: 0 0 10px 0; font-family: 'Orbitron'; color: #fff; font-size: 1.3rem; }
        .card p { color: #888; margin: 5px 0; font-size: 0.95rem; }

        .buy-btn { 
            width: 100%; padding: 20px; margin-top: 20px; border: none; 
            font-family: 'Orbitron'; font-weight: 900; cursor: pointer; border-radius: 10px; 
            text-transform: uppercase; font-size: 1rem; transition: 0.2s;
        }
        .can-afford { background: var(--gold); color: #000; box-shadow: 0 5px 15px rgba(255, 204, 0, 0.2); }
        .cant-afford { background: var(--disabled); color: #444; cursor: not-allowed; }

        .choice-btn { 
            width: 100%; padding: 22px; margin: 10px 0; font-family: 'Orbitron'; 
            font-weight: 900; cursor: pointer; border-radius: 12px; border: none; 
            font-size: 1rem; transition: 0.3s;
        }

        .social-link { 
            position: fixed; bottom: 40px; right: 40px; background: var(--royal); 
            color: #fff; padding: 22px 45px; border-radius: 60px; font-family: 'Orbitron'; 
            font-weight: 900; border: none; cursor: pointer; z-index: 100;
            box-shadow: 0 15px 40px rgba(112, 0, 255, 0.4);
        }
        .social-link:hover { transform: scale(1.05); filter: brightness(1.2); }

        #sync-notif {
            position: fixed; bottom: 20px; left: 20px; font-family: 'Orbitron';
            font-size: 10px; color: var(--success); opacity: 0; transition: 0.5s;
            background: rgba(0,0,0,0.8); padding: 10px; border: 1px solid var(--success);
        }
    </style>
</head>
<body>

<div id="news-ticker"><div class="ticker-wrap" id="ticker-text">MARKET STABLE... NO RECENT HOSTILE ACTIONS... WELCOME CEO...</div></div>
<div id="sync-notif">CLOUD_SYNC_SUCCESSFUL</div>

<div id="startup-overlay">
    <div class="startup-box">
        <h1 style="font-family:'Orbitron'; color:var(--gold); font-size: 2.5rem; margin-bottom: 10px;">MOUSEBREAKER EMPIRE</h1>
        <p style="color:#666; letter-spacing: 3px; margin-bottom: 30px;">SECURE YOUR LEGACY</p>
        <input type="text" id="input-corp" class="startup-input" placeholder="CONGLOMERATE NAME...">
        <input type="text" id="input-ceo" class="startup-input" placeholder="CEO NAME...">
        <button class="buy-btn can-afford" onclick="startGame()">INITIALIZE BOARDROOM</button>
    </div>
</div>

<div id="crisis-overlay">
    <div class="crisis-box">
        <h1 id="rival-title" style="color:var(--danger); font-family:'Orbitron'; font-size: 2.5rem;">CRITICAL BREACH</h1>
        <p id="crisis-msg" style="color:#aaa; font-size: 1.1rem; margin-bottom: 40px;">Rival forces have initiated a hostile takeover.</p>
        
        <button class="choice-btn" style="background:var(--royal); color:white;" onclick="resolveCrisis('lawyer')">HIRE ELITE LEGAL TEAM (25% CASH)</button>
        <button class="choice-btn" style="background:var(--gold); color:black;" id="grind-btn-ui" onclick="resolveCrisis('grind')">DEFEND INTERNALLY (100 TAPS)</button>
        <button class="choice-btn" style="background:#222; color:#fff;" onclick="resolveCrisis('streets')">FLEE TO THE STREETS (RESET STAFF/50% INCOME)</button>
    </div>
</div>

<div class="empire-hud">
    <div>
        <div id="hud-corp" style="font-family:'Orbitron'; color:var(--gold); font-size: 1.4rem; font-weight: 900;">...</div>
        <div id="hud-timer" style="color:var(--danger); font-size: 0.85rem; letter-spacing: 1px; font-weight: 700;">NEXT ATTACK: 10:00</div>
    </div>
    <div style="text-align:center;">
        <div class="capital-display" id="val-money">$0</div>
        <div id="val-pps" style="color:var(--success); font-family:'Orbitron'; font-size: 0.9rem; font-weight: 700;">NET REVENUE: $0/S</div>
    </div>
    <div style="display:flex; gap:10px;">
        <button class="buy-btn can-afford" style="width:auto; padding:15px 45px; margin-top:0;" onclick="manualTap()">TAP REVENUE</button>
        <button class="buy-btn" style="width:auto; padding:15px; margin-top:0; background:#111; border:1px solid #333; color:#555;" onclick="forceSave()">ðŸ’¾</button>
    </div>
</div>

<div class="main-layout">
    <div class="content-area">
        <div class="tabs-nav">
            <button class="tab-btn active" onclick="switchTab('biz')">Holdings</button>
            <button class="tab-btn" onclick="switchTab('stocks')">Exchange</button>
            <button class="tab-btn" onclick="switchTab('staff')">Personnel</button>
        </div>

        <div id="biz" class="view active"><div class="grid-list" id="list-biz"></div></div>
        <div id="stocks" class="view"><div class="grid-list" id="list-stocks"></div></div>
        <div id="staff" class="view"><div class="grid-list" id="list-staff"></div></div>

        <div style="margin-top:100px; padding:40px; border-top:1px solid #222; opacity:0.3; font-family:'Orbitron'; font-size:0.7rem;">
            <h3>BOARDROOM_SYSTEM_LOGS_V4.02</h3>
            <p>> Initializing secure handshake with local_storage...</p>
            <p>> Encrypting financial assets under MOUSEBREAKER protocol...</p>
            <p>> All transactions are final and recorded in the permanent ledger.</p>
        </div>
    </div>

    <div class="enemy-sidebar">
        <h3 style="font-family:'Orbitron'; color:var(--danger); font-size: 1rem; border-bottom: 1px solid #222; padding-bottom: 15px; margin-bottom: 25px;">THREAT PROFILES</h3>
        <div id="list-enemies"></div>
        
        <div style="margin-top:50px; padding:20px; background:rgba(255,0,0,0.05); border-radius:10px; border:1px solid rgba(255,0,0,0.1);">
            <h4 style="font-family:'Orbitron'; color:var(--danger); font-size:0.7rem; margin:0;">INTELLIGENCE_REPORT</h4>
            <p style="font-size:0.65rem; color:#666; line-height:1.6; margin-top:10px;">
                Our satellites indicate increased activity in the Volkov sector. 
                Hostile takeovers are trending upward by 14.2% this quarter. 
                Ensure your staff is loyal and your cash reserves are diversified into stocks.
            </p>
        </div>
    </div>
</div>

<button class="social-link" onclick="exitToSocial()">GO TO SOCIAL LIFE â†’</button>

<script>
    const SAVE_KEY = 'mb_empire_save';

    // FIX: Initial money set to 1,000,000
    let state = {
        money: 1000000,
        pps: 0,
        tap: 10,
        timer: 600,
        isCrisis: false,
        tapsNeeded: 0,
        corp: "MOUSEBREAKER",
        ceo: "ADMIN",
        portfolio: {},
        boughtAssets: [], 
        staffLevels: []   
    };

    const assets = [
        { n: "Luxury Hotel", c: 5e6, i: 1.5e5 }, { n: "Cargo Port", c: 8e7, i: 2.5e6 },
        { n: "AI Server Farm", c: 1e9, i: 4e7 }, { n: "Bio-Gen Lab", c: 1e10, i: 5e8 },
        { n: "Deep Sea Mine", c: 1e11, i: 4e9 }, { n: "Moon Base Alpha", c: 5e11, i: 2e10 },
        { n: "Mars Colony", c: 2e12, i: 1e11 }, { n: "Venus Cloud City", c: 1e13, i: 8e11 },
        { n: "Asteroid Rig", c: 5e13, i: 3e12 }, { n: "Dyson Swarm", c: 1e15, i: 8e13 },
        { n: "Star Forge", c: 1e16, i: 7e14 }, { n: "Wormhole Bridge", c: 1e17, i: 6e15 },
        { n: "Reality Core", c: 1e18, i: 5e16 }, { n: "Dimension Gate", c: 1e20, i: 4e18 },
        { n: "Galaxy Bank", c: 1e22, i: 3e20 }, { n: "Soul Market", c: 1e24, i: 2e22 },
        { n: "Existence Engine", c: 1e26, i: 1e24 }, { n: "Universal Hub", c: 1e28, i: 9e26 },
        { n: "Timeline Tether", c: 1e30, i: 8e28 }, { n: "Void Anchor", c: 1e32, i: 7e30 },
        { n: "Concept Pillar", c: 1e34, i: 6e32 }, { n: "Omni-Matrix", c: 1e36, i: 5e34 },
        { n: "Final Singularity", c: 1e38, i: 4e36 }, { n: "Paradox Loop", c: 1e40, i: 3e38 },
        { n: "The Creator Asset", c: 1e45, i: 1e43 }
    ];

    const stocks = [
        { id: "MBRK", n: "MouseBreaker", p: 150, v: 0.4 }, { id: "GOLD", n: "Gold Reserves", p: 2500, v: 0.1 },
        { id: "CRUDE", n: "Global Oil", p: 85, v: 0.25 }, { id: "AIXX", n: "Neural AI", p: 1e5, v: 0.6 },
        { id: "VOID", n: "Dark Matter", p: 1e8, v: 0.9 }, { id: "TIME", n: "Chronos Tech", p: 1e10, v: 0.5 },
        { id: "LIFE", n: "Eternity Lab", p: 1e12, v: 0.3 }, { id: "GODX", n: "Divine Stock", p: 1e15, v: 0.05 },
        { id: "SOUL", n: "Aether Share", p: 1e18, v: 0.7 }, { id: "NULL", n: "Zero Logic", p: 1e21, v: 0.99 },
        { id: "INF", n: "Infinity Share", p: 1e25, v: 0.15 }, { id: "END", n: "The Omega", p: 1e30, v: 0.8 }
    ];

    const staff = [
        { n: "Intern", c: 1e5, p: "+2k Tap", v: 2000, type: 'tap' },
        { n: "Junior Dev", c: 5e6, p: "+10k Tap", v: 10000, type: 'tap' },
        { n: "CFO", c: 1e9, p: "+25% Income", v: 0.25, type: 'pps' },
        { n: "Market AI", c: 5e10, p: "+50% Income", v: 0.5, type: 'pps' },
        { n: "Hacker Prime", c: 2e11, p: "Crisis Defense", v: 0, type: 'spec' },
        { n: "AI Archon", c: 1e13, p: "2x All Income", v: 1.0, type: 'pps' },
        { n: "Time Wizard", c: 1e16, p: "+1e10 Tap", v: 1e10, type: 'tap' },
        { n: "Space Admiral", c: 1e18, p: "4x Income", v: 3.0, type: 'pps' },
        { n: "Shadow CEO", c: 1e21, p: "8x Income", v: 7.0, type: 'pps' },
        { n: "Demi-God", c: 1e25, p: "100x Income", v: 99.0, type: 'pps' },
        { n: "The Oracle", c: 1e30, p: "Infinite PPS", v: 999.0, type: 'pps' },
        { n: "Reality Smith", c: 1e35, p: "+1e25 Tap", v: 1e25, type: 'tap' }
    ];

    const enemies = [
        { n: "Victor Volkov", t: 15, msg: "Is liquidating your shell companies." },
        { n: "The Iron Duchess", t: 35, msg: "Is shorting your space stocks." },
        { n: "Silicon Overlord", t: 60, msg: "Is hacking your AI servers." },
        { n: "General Grime", t: 85, msg: "Is seizing your moon bases." },
        { n: "The Architect", t: 100, msg: "Is erasing your reality." }
    ];

    function forceSave() {
        localStorage.setItem(SAVE_KEY, JSON.stringify(state));
        const notif = document.getElementById('sync-notif');
        if(notif) {
            notif.style.opacity = '1';
            setTimeout(() => { notif.style.opacity = '0'; }, 2000);
        }
    }

    function loadGame() {
        const savedData = localStorage.getItem(SAVE_KEY);
        if (savedData) {
            const parsed = JSON.parse(savedData);
            state = { ...state, ...parsed };
            
            // Re-calc asset costs based on length of purchase history
            state.boughtAssets.forEach(index => {
                if(assets[index]) assets[index].c *= 1.4;
            });
            state.staffLevels.forEach(index => {
                if(staff[index]) staff[index].c *= 10;
            });

            document.getElementById('startup-overlay').style.display = 'none';
            document.getElementById('hud-corp').innerText = state.corp;
            updateUI();
        }
    }

    function startGame() {
        state.corp = document.getElementById('input-corp').value || "CORP INC";
        state.ceo = document.getElementById('input-ceo').value || "CEO";
        document.getElementById('hud-corp').innerText = state.corp;
        document.getElementById('startup-overlay').style.display = 'none';
        forceSave();
        updateUI();
    }

    function fmt(n) {
        if (n < 1e3) return "$" + n.toFixed(0);
        if (n < 1e6) return "$" + (n/1e3).toFixed(1) + "K";
        if (n < 1e9) return "$" + (n/1e6).toFixed(1) + "M";
        if (n < 1e12) return "$" + (n/1e9).toFixed(1) + "B";
        if (n < 1e15) return "$" + (n/1e12).toFixed(1) + "T";
        if (n < 1e18) return "$" + (n/1e15).toFixed(1) + "Q";
        return "$" + n.toExponential(2);
    }

    function updateUI() {
        document.getElementById('val-money').innerText = fmt(state.money);
        document.getElementById('val-pps').innerText = "NET REVENUE: " + fmt(state.pps) + "/S";

        document.getElementById('list-biz').innerHTML = assets.map((a, i) => {
            let aff = state.money >= a.c;
            return `<div class="card"><h3>${a.n}</h3><p>Yield: ${fmt(a.i)}/s</p>
            <button class="buy-btn ${aff?'can-afford':'cant-afford'}" onclick="if(${aff}){buyAsset(${i})}" ${!aff?'disabled':''}>ACQUIRE ${fmt(a.c)}</button></div>`;
        }).join('');

        document.getElementById('list-stocks').innerHTML = stocks.map((s, i) => {
            let aff = state.money >= s.p;
            let own = state.portfolio[s.id] || 0;
            return `<div class="card"><h3>${s.n}</h3><h2 style="color:var(--success)">${fmt(s.p)}</h2><p>Shares Owned: ${own}</p>
            <button class="buy-btn ${aff?'can-afford':'cant-afford'}" onclick="if(${aff}){buyStock(${i})}" ${!aff?'disabled':''}>BUY SHARE</button>
            <button class="buy-btn" style="background:#333; color:#fff;" onclick="sellStock(${i})">SELL ALL</button></div>`;
        }).join('');

        document.getElementById('list-staff').innerHTML = staff.map((s, i) => {
            let aff = state.money >= s.c;
            return `<div class="card"><h3>${s.n}</h3><p style="color:var(--royal); font-weight:900;">${s.p}</p>
            <button class="buy-btn ${aff?'can-afford':'cant-afford'}" onclick="if(${aff}){buyStaff(${i})}" ${!aff?'disabled':''}>HIRE: ${fmt(s.c)}</button></div>`;
        }).join('');

        document.getElementById('list-enemies').innerHTML = enemies.map(e => `
            <div class="enemy-card">
                <div style="font-weight:900; font-size:0.9rem; color:#fff;">${e.n.toUpperCase()}</div>
                <div style="font-size:0.75rem; color:#666; margin-top:5px;">${e.msg}</div>
                <div class="threat-bar"><div class="threat-fill" style="width:${e.t}%"></div></div>
            </div>`).join('');
    }

    function buyAsset(i) { 
        state.money -= assets[i].c; 
        state.pps += assets[i].i; 
        assets[i].c *= 1.4; 
        state.boughtAssets.push(i);
        forceSave();
        updateUI(); 
    }

    function buyStock(i) { 
        state.money -= stocks[i].p; 
        state.portfolio[stocks[i].id] = (state.portfolio[stocks[i].id] || 0) + 1; 
        forceSave();
        updateUI(); 
    }

    function sellStock(i) { 
        let amt = state.portfolio[stocks[i].id] || 0;
        state.money += (amt * stocks[i].p);
        state.portfolio[stocks[i].id] = 0;
        forceSave();
        updateUI();
    }

    function buyStaff(i) { 
        state.money -= staff[i].c;
        if(staff[i].type === 'pps') state.pps *= (1 + staff[i].v);
        if(staff[i].type === 'tap') state.tap += staff[i].v;
        staff[i].c *= 10;
        state.staffLevels.push(i);
        forceSave();
        updateUI();
    }

    // FIX: manualTap now saves immediately to sync with Social page
    function manualTap() {
        if(state.isCrisis) {
            state.tapsNeeded--;
            document.getElementById('grind-btn-ui').innerText = `TAP TO DEFEND: ${state.tapsNeeded} LEFT`;
            if(state.tapsNeeded <= 0) endCrisis();
        } else {
            state.money += state.tap;
        }
        updateUI();
        forceSave(); 
    }

    setInterval(() => {
        if(!state.isCrisis) {
            state.timer--;
            let m = Math.floor(state.timer / 60);
            let s = state.timer % 60;
            let timerEl = document.getElementById('hud-timer');
            if(timerEl) timerEl.innerText = `NEXT ATTACK: ${m}:${s<10?'0':''}${s}`;
            if(state.timer <= 0) triggerCrisis();
            state.money += state.pps;
            updateUI();
        }
    }, 1000);

    function triggerCrisis() {
        state.isCrisis = true;
        state.tapsNeeded = 100;
        let ri = enemies[Math.floor(Math.random()*enemies.length)];
        document.getElementById('rival-title').innerText = ri.n + " ATTACK";
        document.getElementById('crisis-overlay').style.display = 'flex';
        forceSave();
    }

    function resolveCrisis(type) {
        if(type === 'lawyer') { state.money *= 0.75; endCrisis(); }
        else if(type === 'streets') { state.pps *= 0.5; endCrisis(); }
    }

    function endCrisis() {
        state.isCrisis = false;
        state.timer = 600;
        document.getElementById('crisis-overlay').style.display = 'none';
        forceSave();
        updateUI();
    }

    function switchTab(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.target.classList.add('active');
    }

    function exitToSocial() {
        forceSave();
        window.location.href = 'social.html';
    }

    const headlines = [
        "MOUSEBREAKER STOCK UP 15% ON NEW NEWS", "RIVAL VICTOR VOLKOV SEEN BUYING LUXURY YACHTS", 
        "DARK MATTER PRICES PLUMMET AS VOID TECH EXPANDS", "BOARDROOM SECURITY UPGRADED TO LEVEL 9",
        "NEW GALAXY BANK OPENING ON MARS NEXT MONTH"
    ];
    setInterval(() => {
        document.getElementById('ticker-text').innerText = headlines[Math.floor(Math.random()*headlines.length)];
    }, 10000);

    setInterval(() => {
        stocks.forEach(s => {
            let change = (Math.random() - 0.48) * 2 * s.v;
            s.p *= (1 + change);
            if(s.p < 50) s.p = 50;
        });
        updateUI();
    }, 2500);

    window.onload = loadGame;
</script>
</body>
</html>
